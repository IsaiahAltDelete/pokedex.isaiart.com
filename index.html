<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>National Pokédex</title>
    <link rel="icon" href="icon.ico" type="image/x-icon">
    <style>
        :root {
            --bg-color: #e0e5ec;
            --text-color: #4a4a4a;
            --shadow-light: #ffffff;
            --shadow-dark: #bec3c9;
            --screen-color: #c8d0e7;
            --pokemon-color: #e0e5ec;
        }
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Arial', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: all 0.5s ease;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .pokedex {
            background-color: var(--bg-color);
            border-radius: 25px;
            box-shadow: 10px 10px 30px var(--shadow-dark), 
                        -10px -10px 30px var(--shadow-light);
            padding: 20px;
            width: 90%;
            max-width: 400px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            transition: all 0.5s ease;
        }
        .screen {
            background-color: var(--screen-color);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: inset 5px 5px 10px var(--shadow-dark), 
                        inset -5px -5px 10px var(--shadow-light);
            flex-grow: 1;
            overflow-y: auto;
            width: 100%;
            transition: all 0.5s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #pokemonInfo {
            font-size: 14px;
            line-height: 1.3;
            text-align: center;
            width: 100%;
        }
        #pokemonInfo img {
            width: 120px;
            height: 120px;
            margin: 0 auto 10px;
            display: block;
            transition: all 0.5s ease;
            animation: bounce 2s infinite;
            animation-delay: 6s;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-30px);
            }
            60% {
                transform: translateY(-15px);
            }
        }
        input, button {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: none;
            border-radius: 10px;
            background-color: var(--bg-color);
            box-shadow: 3px 3px 6px var(--shadow-dark), 
                        -3px -3px 6px var(--shadow-light);
            font-size: 14px;
            color: var(--text-color);
            transition: all 0.3s ease;
            text-align: center;
        }
        button {
            cursor: pointer;
        }
        button:active {
            box-shadow: inset 3px 3px 6px var(--shadow-dark), 
                        inset -3px -3px 6px var(--shadow-light);
        }
        h1, h2 {
            margin: 10px 0;
            font-size: 1.2em;
            transition: all 0.5s ease;
            text-align: center;
            width: 100%;
        }
        .slider {
            width: 60px;
            height: 30px;
            background-color: var(--bg-color);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 3px;
            margin: 10px auto;
            box-shadow: inset 2px 2px 5px var(--shadow-dark), 
                        inset -2px -2px 5px var(--shadow-light);
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
        }
        .pokeball {
            width: 24px;
            height: 24px;
            position: absolute;
            left: 3px;
            transition: transform 0.5s ease;
        }
        .dark-mode {
            --bg-color: #2d3748;
            --text-color: #e2e8f0;
            --shadow-light: #3a4a63;
            --shadow-dark: #1e2a3a;
            --screen-color: #4a5568;
        }
        .dark-mode .pokeball {
            transform: translateX(30px) rotate(360deg);
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }
        .navigation button {
            width: 48%;
        }
        .type-badge {
            display: inline-block;
            padding: 3px 6px;
            margin: 2px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="pokedex">
        <h1>Pokédex</h1>
        <div class="slider" onclick="toggleDarkMode()">
            <svg class="pokeball" viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="redGradient" x1="0%" y1="0%" x2="100%">
                        <stop offset="0%" style="stop-color:#ff6b6b;"></stop>
                        <stop offset="100%" style="stop-color:#ee5253;"></stop>
                    </linearGradient>
                    <linearGradient id="whiteGradient" x1="0%" y1="0%" x2="100%">
                        <stop offset="0%" style="stop-color:#ffffff;"></stop>
                        <stop offset="100%" style="stop-color:#f1f2f6;"></stop>
                    </linearGradient>
                </defs>
                <circle cx="50" cy="50" r="50" fill="url(#redGradient)"></circle>
                <path d="M100 50 H0 C0 77.6 22.4 100 50 100 C77.6 100 100 77.6 100 50" fill="url(#whiteGradient)"></path>
                <circle cx="50" cy="50" r="20" fill="#ffffff" stroke="#333" stroke-width="4"></circle>
                <circle cx="50" cy="50" r="11" fill="#333"></circle>
            </svg>
        </div>
        <div class="screen">
            <div id="pokemonInfo">
                <p>Enter a Pokémon name to see its info!</p>
            </div>
        </div>
        <input type="text" id="pokemonName" placeholder="Enter Pokémon name">
        <button onclick="fetchPokemonInfo()">Search</button>
        <div class="navigation">
            <button onclick="navigatePokemon(-1)">Previous</button>
            <button onclick="navigatePokemon(1)">Next</button>
        </div>
    </div>

    <script>
        let currentPokemonId = 1;

        const typeColors = {
            normal: "#A8A878", fire: "#F08030", water: "#6890F0", electric: "#F8D030", grass: "#78C850",
            ice: "#98D8D8", fighting: "#C03028", poison: "#A040A0", ground: "#E0C068", flying: "#A890F0",
            psychic: "#F85888", bug: "#A8B820", rock: "#B8A038", ghost: "#705898", dragon: "#7038F8",
            dark: "#705848", steel: "#B8B8D0", fairy: "#EE99AC"
        };

        function setThemeColor(color1, color2) {
            const gradientColor = color2 ? `linear-gradient(${color1}, ${color2})` : color1;
            document.documentElement.style.setProperty('--pokemon-color', gradientColor);
            document.documentElement.style.setProperty('--bg-color', gradientColor);
            const luminance = calculateLuminance(color1);
            const textColor = luminance > 0.5 ? "#333333" : "#FFFFFF";
            document.documentElement.style.setProperty('--text-color', textColor);
            document.documentElement.style.setProperty('--shadow-light', luminance > 0.5 ? lightenColor(color1, 20) : lightenColor(color1, 10));
            document.documentElement.style.setProperty('--shadow-dark', luminance > 0.5 ? darkenColor(color1, 10) : darkenColor(color1, 20));
        }

        function calculateLuminance(hex) {
            const rgb = parseInt(hex.slice(1), 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >>  8) & 0xff;
            const b = (rgb >>  0) & 0xff;
            return (0.299 * r + 0.587 * g + 0.114 * b) / 255;
        }

        function lightenColor(color, percent) {
            const num = parseInt(color.replace("#",""), 16),
                amt = Math.round(2.55 * percent),
                R = (num >> 16) + amt,
                B = (num >> 8 & 0x00FF) + amt,
                G = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R<255?R<1?0:R:255)*0x10000 + (B<255?B<1?0:B:255)*0x100 + (G<255?G<1?0:G:255)).toString(16).slice(1);
        }

        function darkenColor(color, percent) {
            const num = parseInt(color.replace("#",""), 16),
                amt = Math.round(2.55 * percent),
                R = (num >> 16) - amt,
                B = (num >> 8 & 0x00FF) - amt,
                G = (num & 0x0000FF) - amt;
            return "#" + (0x1000000 + (R>0?R:0)*0x10000 + (B>0?B:0)*0x100 + (G>0?G:0)).toString(16).slice(1);
        }

        async function fetchPokemonInfo(pokemonId) {
            const pokemonName = pokemonId ? pokemonId : document.getElementById('pokemonName').value.toLowerCase();
            const infoDiv = document.getElementById('pokemonInfo');
            infoDiv.innerHTML = 'Loading...';
            
            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${pokemonName}`);
                if (!response.ok) {
                    throw new Error('Pokémon not found');
                }
                const data = await response.json();
                
                const speciesResponse = await fetch(data.species.url);
                const speciesData = await speciesResponse.json();
                
                const flavorText = speciesData.flavor_text_entries.find(entry => entry.language.name === "en").flavor_text;
                
                currentPokemonId = data.id;

                const mainType = data.types[0].type.name;
                const secondaryType = data.types[1] ? data.types[1].type.name : null;
                const typeColor = typeColors[mainType];
                const typeColor2 = secondaryType ? typeColors[secondaryType] : null;
                setThemeColor(typeColor, typeColor2);

                const typeBadges = data.types.map(type => 
                    `<span class="type-badge" style="background-color: ${typeColors[type.type.name]}">
                        ${type.type.name.toUpperCase()}
                    </span>`
                ).join('');

                // Immediately set the image
                infoDiv.innerHTML = `<img src="${data.sprites.front_default}" alt="${data.name}">`;

                const content = `
                    <h2>${data.name.charAt(0).toUpperCase() + data.name.slice(1)}</h2>
                    <p>${typeBadges}</p>
                    <p>Height: ${data.height / 10} m</p>
                    <p>Weight: ${data.weight / 10} kg</p>
                    <p>Abilities: ${data.abilities.map(ability => ability.ability.name).join(', ')}</p>
                    <p>Base Experience: ${data.base_experience}</p>
                    <p>${flavorText}</p>
                `;

                typewriterEffect(infoDiv, content);
            } catch (error) {
                infoDiv.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }

        function typewriterEffect(element, html) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            const textNodes = [...tempDiv.childNodes].flatMap(node => 
                node.nodeType === Node.TEXT_NODE ? node.textContent.split('') : [node]
            );

            let i = 0;
            const speed = 10; // Adjust for faster/slower typing

            function type() {
                if (i < textNodes.length) {
                    if (typeof textNodes[i] === 'string') {
                        element.appendChild(document.createTextNode(textNodes[i]));
                    } else {
                        element.appendChild(textNodes[i].cloneNode(true));
                    }
                    i++;
                    setTimeout(type, speed);
                }
            }

            type();
        }

        function toggleDarkMode() {
            const pokeball = document.querySelector('.pokeball');
            pokeball.classList.add('rolling');
            setTimeout(() => {
                document.body.classList.toggle('dark-mode');
            }, 250);
            setTimeout(() => {
                pokeball.classList.remove('rolling');
            }, 500);
        }

        function navigatePokemon(direction) {
            currentPokemonId += direction;
            if (currentPokemonId < 1) currentPokemonId = 1;
            fetchPokemonInfo(currentPokemonId);
        }

        // Event listener for Enter key on search input
        document.getElementById('pokemonName').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                fetchPokemonInfo();
            }
        });

        // Initial load
        fetchPokemonInfo(1);
    </script>
</body>
</html>
