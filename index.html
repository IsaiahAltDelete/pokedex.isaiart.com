<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pok√©mon Explorer</title>
  <style>
    :root {
      --background: #121212;
      --surface: #1e1e1e;
      --surface-light: #2e2e2e;
      --primary: #bb86fc;
      --secondary: #03dac6;
      --on-background: #e0e0e0;
      --on-surface: #ffffff;
      --normal: #A8A878;
      --fighting: #C03028;
      --flying: #A890F0;
      --poison: #A040A0;
      --ground: #E0C068;
      --rock: #B8A038;
      --bug: #A8B820;
      --ghost: #705898;
      --steel: #B8B8D0;
      --fire: #F08030;
      --water: #6890F0;
      --grass: #78C850;
      --electric: #F8D030;
      --psychic: #F85888;
      --ice: #98D8D8;
      --dragon: #7038F8;
      --dark: #705848;
      --fairy: #EE99AC;
    }

    body {
      background-color: var(--background);
      color: var(--on-background);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      font-size: 16px;
    }

    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      box-sizing: border-box;
    }

    header {
      background-color: var(--surface);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    h1 {
      margin: 0;
      color: var(--primary);
      font-size: 2em;
    }

    .search-container {
      display: flex;
      align-items: center;
    }

    input[type="text"] {
      padding: 10px 15px;
      border: none;
      border-radius: 25px;
      width: 250px;
      background-color: var(--surface-light);
      color: var(--on-surface);
      font-size: 1em;
    }

    button {
      padding: 10px 15px;
      border: none;
      border-radius: 25px;
      background-color: var(--primary);
      color: var(--on-surface);
      cursor: pointer;
      font-size: 1em;
      margin-left: 10px;
      transition: background-color 0.3s;
    }

    .slider-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    #pokedexSlider {
      -webkit-appearance: none;
      width: 200px;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      outline: none;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    #pokedexSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--on-surface);
      cursor: pointer;
    }

    .main-container {
      display: flex;
      gap: 20px;
    }

    .recent-pokemon-list {
      width: 80px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-right: 20px;
    }

    .recent-pokemon-list img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.3s;
      background-color: var(--surface-light);
    }

    .recent-pokemon-list img:hover {
      transform: scale(1.1);
    }

    .pokemon-content {
      flex: 1;
      display: flex;
      gap: 20px;
      height: calc(100vh - 200px);
      overflow: auto;
    }

    .main-info {
      flex: 1;
      background-color: var(--surface);
      border-radius: 15px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }

    .additional-info {
      flex: 2;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .card {
      background-color: var(--surface);
      border-radius: 15px;
      padding: 20px;
      font-size: 1em;
    }

    .pokemon-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .pokemon-name {
      font-size: 2em;
      margin: 0;
    }

    .pokemon-id {
      font-size: 1.5em;
      color: var(--secondary);
    }

    .pokemon-images {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .pokemon-images img {
      width: 150px;
      height: 150px;
    }

    .type {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      color: var(--on-surface);
      font-size: 1em;
      margin-right: 10px;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .info-item {
      background-color: var(--surface-light);
      padding: 10px;
      border-radius: 10px;
      font-size: 1em;
    }

    .info-label {
      font-weight: bold;
      color: var(--secondary);
    }

    .evolution-chain {
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    .evolution-stage {
      text-align: center;
      font-size: 1em;
    }

    .evolution-stage img {
      width: 80px;
      height: 80px;
    }

    footer {
      margin-top: auto;
      text-align: center;
      padding: 20px;
    }

    #loadingSpinner {
      width: 50px;
      height: 50px;
      border: 5px solid var(--surface-light);
      border-top: 5px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    .type-box {
      display: inline-block;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      margin: 4px;
      font-size: 1em;
      text-align: center;
      line-height: 40px;
      color: var(--on-surface);
      position: relative;
      cursor: pointer;
    }

    .type-box::after {
      content: attr(title);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--surface);
      color: var(--on-surface);
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.8em;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
      pointer-events: none;
      z-index: 1;
    }

    .type-box:hover::after {
      opacity: 1;
      visibility: visible;
    }

    .matchups-container {
      display: flex;
      gap: 20px;
    }

    .matchup-group {
      flex: 1;
    }

    .normal { background-color: var(--normal); }
    .fighting { background-color: var(--fighting); }
    .flying { background-color: var(--flying); }
    .poison { background-color: var(--poison); }
    .ground { background-color: var(--ground); }
    .rock { background-color: var(--rock); }
    .bug { background-color: var(--bug); }
    .ghost { background-color: var(--ghost); }
    .steel { background-color: var(--steel); }
    .fire { background-color: var(--fire); }
    .water { background-color: var(--water); }
    .grass { background-color: var(--grass); }
    .electric { background-color: var(--electric); }
    .psychic { background-color: var(--psychic); }
    .ice { background-color: var(--ice); }
    .dragon { background-color: var(--dragon); }
    .dark { background-color: var(--dark); }
    .fairy { background-color: var(--fairy); }

    .stats-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .stat-bar {
      background-color: var(--surface-light);
      border-radius: 5px;
      height: 20px;
      position: relative;
      overflow: hidden;
    }

    .stat-fill {
      height: 100%;
      background-color: var(--primary);
      transition: width 0.5s ease-out;
    }

    .stat-value {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--on-surface);
      font-size: 0.8em;
    }

    .abilities-container {
      margin-top: 20px;
    }

    .ability-item {
      background-color: var(--surface-light);
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .ability-name {
      font-weight: bold;
      color: var(--secondary);
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Pok√©mon Explorer</h1>
      <div class="search-container">
        <input type="text" id="pokemonSearch" placeholder="Search Pok√©mon" oninput="autofillPokemon()" onkeydown="if(event.key === 'Enter') searchPokemon()">
        <button onclick="searchPokemon()">üîç</button>
        <button onclick="searchRandomPokemon()">üé≤</button>
      </div>
      <div class="slider-container">
        <button onclick="previousPokemon()">‚¨ÖÔ∏è</button>
        <input type="range" id="pokedexSlider" min="1" max="1025" value="1" onchange="sliderChange()">
        <button onclick="nextPokemon()">‚û°Ô∏è</button>
      </div>
    </header>
    <div class="main-container">
      <div id="recentPokemon" class="recent-pokemon-list">
        <!-- Recent Pok√©mon list will be here -->
      </div>
      <div id="pokemonData" class="pokemon-content">
        <!-- Pok√©mon data will be displayed here -->
      </div>
    </div>
  </div>
  <div id="loadingSpinner"></div>
  <script>
    const apiUrl = 'https://pokeapi.co/api/v2/';
    let recentPokemon = [];
    let currentPokemonId = 1;

    async function searchPokemon(pokemonName = document.getElementById('pokemonSearch').value.toLowerCase()) {
      showLoadingSpinner();
      try {
        const response = await fetch(`${apiUrl}pokemon/${pokemonName}`);
        if (!response.ok) {
          throw new Error('Pok√©mon not found');
        }
        const data = await response.json();
        displayPokemon(data);
        addToRecent(data);
        document.getElementById('pokemonSearch').value = '';  // Clear search bar
      } catch (error) {
        console.error('Error fetching Pok√©mon data:', error);
      } finally {
        hideLoadingSpinner();
      }
    }

    function sliderChange() {
      const sliderValue = document.getElementById('pokedexSlider').value;
      searchPokemonById(sliderValue);
    }

    async function searchPokemonById(id) {
      showLoadingSpinner();
      try {
        const response = await fetch(`${apiUrl}pokemon/${id}`);
        if (!response.ok) {
          throw new Error('Pok√©mon not found');
        }
        const data = await response.json();
        displayPokemon(data);
        addToRecent(data);
      } catch (error) {
        console.error('Error fetching Pok√©mon data:', error);
      } finally {
        hideLoadingSpinner();
      }
    }

    async function searchRandomPokemon() {
      const randomId = Math.floor(Math.random() * 1010) + 1;
      searchPokemonById(randomId);
    }

    async function previousPokemon() {
      if (currentPokemonId > 1) {
        currentPokemonId--;
        searchPokemonById(currentPokemonId);
      }
    }

    async function nextPokemon() {
      if (currentPokemonId < 1010) {
        currentPokemonId++;
        searchPokemonById(currentPokemonId);
      }
    }

    async function getPokemonDescription(id) {
      try {
        const response = await fetch(`${apiUrl}pokemon-species/${id}`);
        const data = await response.json();
        const descriptionEntry = data.flavor_text_entries.find(entry => entry.language.name === 'en');
        return descriptionEntry ? descriptionEntry.flavor_text : 'No description available.';
      } catch (error) {
        console.error('Error fetching Pok√©mon description:', error);
        return 'No description available.';
      }
    }

    async function getEvolutionChain(url) {
      try {
        const response = await fetch(url);
        const data = await response.json();
        const evolutionChain = [];
        let currentStage = data.chain;

        while (currentStage) {
          evolutionChain.push({
            species_name: currentStage.species.name,
            min_level: currentStage.evolution_details.length ? currentStage.evolution_details[0].min_level : null,
            trigger_name: currentStage.evolution_details.length ? currentStage.evolution_details[0].trigger.name : null
          });
          currentStage = currentStage.evolves_to[0];
        }

        return evolutionChain;
      } catch (error) {
        console.error('Error fetching evolution chain:', error);
        return [];
      }
    }

    async function getPokemonImage(name) {
      try {
        const response = await fetch(`${apiUrl}pokemon/${name}`);
        const data = await response.json();
        return data.sprites.front_default;
      } catch (error) {
        console.error('Error fetching Pok√©mon image:', error);
        return '';
      }
    }

    async function displayPokemon(data) {
      const description = await getPokemonDescription(data.id);
      const speciesData = await fetch(`${apiUrl}pokemon-species/${data.id}`).then(res => res.json());
      const evolutionChain = await getEvolutionChain(speciesData.evolution_chain.url);
      const abilities = await Promise.all(data.abilities.map(ability => getAbilityDescription(ability.ability.url)));
      const pokemonData = document.getElementById('pokemonData');
      const types = data.types.map(type => `<span class="type ${type.type.name}">${type.type.name}</span>`).join(' ');

      const nameStyles = data.types.length > 1 ? 
        `background: linear-gradient(to right, var(--${data.types[0].type.name}), var(--${data.types[1].type.name})); -webkit-background-clip: text; -webkit-text-fill-color: transparent;` : 
        `color: var(--${data.types[0].type.name});`;

      pokemonData.innerHTML = `
        <div class="main-info">
          <div class="pokemon-header">
            <h2 class="pokemon-name" style="${nameStyles}">${data.name.toUpperCase()}</h2>
            <span class="pokemon-id">#${data.id}</span>
          </div>
          <div class="pokemon-images">
            <img src="${data.sprites.front_default}" alt="${data.name}">
            <img src="${data.sprites.front_shiny}" alt="${data.name} Shiny">
          </div>
          <div>${types}</div>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Height:</span> ${data.height / 10} m
            </div>
            <div class="info-item">
              <span class="info-label">Weight:</span> ${data.weight / 10} kg
            </div>
          </div>
          <div class="info-item" style="margin-top: 10px;">
            <span class="info-label">Description:</span> ${description}
          </div>
          <div class="abilities-container">
            <h3>Abilities</h3>
            ${abilities.map(ability => `
              <div class="ability-item">
                <div class="ability-name">${ability.name}</div>
                <div>${ability.description}</div>
              </div>
            `).join('')}
          </div>
        </div>
        <div class="additional-info">
          <div class="card">
            <h3>Base Stats</h3>
            <div class="stats-container">
              ${data.stats.map(stat => `
                <div>
                  <div>${stat.stat.name}: ${stat.base_stat}</div>
                  <div class="stat-bar">
                    <div class="stat-fill" style="width: ${(stat.base_stat / 255) * 100}%"></div>
                    <span class="stat-value">${stat.base_stat}</span>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
          <div class="card">
            <h3>Type Matchups</h3>
            <div class="matchups-container">
              <div class="matchup-group">
                <h4>Weaknesses</h4>
                <div id="weaknesses"></div>
              </div>
              <div class="matchup-group">
                <h4>Resistances</h4>
                <div id="resistances"></div>
              </div>
            </div>
          </div>
          <div class="card">
            <h3>Evolution Line</h3>
            <div class="evolution-chain" id="evolutionChain"></div>
          </div>
        </div>
      `;

      currentPokemonId = data.id;
      document.getElementById('pokedexSlider').value = currentPokemonId;
      getTypeMatchups(data.types.map(type => type.type.url));
      displayEvolutionChain(evolutionChain);
    }

    async function getAbilityDescription(abilityUrl) {
      try {
        const response = await fetch(abilityUrl);
        const data = await response.json();
        const englishEntry = data.effect_entries.find(entry => entry.language.name === 'en');
        return {
          name: data.name,
          description: englishEntry ? englishEntry.effect : 'No description available.'
        };
      } catch (error) {
        console.error('Error fetching ability description:', error);
        return {
          name: 'Unknown',
          description: 'No description available.'
        };
      }
    }

    async function displayEvolutionChain(evolutionChain) {
      if (evolutionChain.length > 1) {
        const evolutionHTML = await Promise.all(evolutionChain.map(async (evolution, index) => {
          const image = await getPokemonImage(evolution.species_name);
          return `
            <div class="evolution-stage">
              <img src="${image}" alt="${evolution.species_name}">
              <p>${evolution.species_name}</p>
              ${evolution.min_level ? `<p>Lvl ${evolution.min_level}</p>` : ''}
              ${index < evolutionChain.length - 1 ? '<p>‚Üí</p>' : ''}
            </div>
          `;
        }));

        document.getElementById('evolutionChain').innerHTML = evolutionHTML.join('');
      } else {
        document.getElementById('evolutionChain').innerHTML = '<p>No evolution chain available.</p>';
      }
    }

    async function getTypeMatchups(typeUrls) {
      const weaknesses = {};
      const resistances = {};

      for (const url of typeUrls) {
        const response = await fetch(url);
        const data = await response.json();

        data.damage_relations.double_damage_from.forEach(type => {
          if (weaknesses[type.name]) {
            weaknesses[type.name] *= 2;
          } else {
            weaknesses[type.name] = 2;
          }
        });

        data.damage_relations.half_damage_from.forEach(type => {
          if (resistances[type.name]) {
            resistances[type.name] *= 0.5;
          } else {
            resistances[type.name] = 0.5;
          }
        });

        data.damage_relations.no_damage_from.forEach(type => {
          resistances[type.name] = 0;
        });
      }

      displayMatchups(weaknesses, resistances);
    }

    function displayMatchups(weaknesses, resistances) {
      const weaknessesContainer = document.getElementById('weaknesses');
      const resistancesContainer = document.getElementById('resistances');

      weaknessesContainer.innerHTML = Object.entries(weaknesses)
        .map(([type, value]) => `<div class="type-box ${type}" title="${type} x${value}">${value}</div>`)
        .join('');

      resistancesContainer.innerHTML = Object.entries(resistances)
        .map(([type, value]) => `<div class="type-box ${type}" title="${type} x${value}">${value}</div>`)
        .join('');
    }

    function addToRecent(data) {
      if (recentPokemon.length >= 5) {
        recentPokemon.shift();
      }
      recentPokemon.push(data);
      updateRecentList();
    }

    function updateRecentList() {
      const recentList = document.getElementById('recentPokemon');
      recentList.innerHTML = recentPokemon.map(pokemon => `
        <img src="${pokemon.sprites.front_default}" 
             alt="${pokemon.name}" 
             title="${pokemon.name}"
             onclick="searchPokemon('${pokemon.name}')">`
      ).join('');
    }

    async function autofillPokemon() {
      const input = document.getElementById('pokemonSearch').value.toLowerCase();
      if (input.length < 2) return;
      const response = await fetch(`${apiUrl}pokemon?limit=1000`);
      const data = await response.json();
      const suggestions = data.results.filter(pokemon => pokemon.name.startsWith(input));
      const suggestionBox = document.getElementById('suggestions');
      suggestionBox.innerHTML = suggestions.slice(0, 5).map(pokemon => `<div onclick="searchPokemon('${pokemon.name}')">${pokemon.name}</div>`).join('');
    }

    function showLoadingSpinner() {
      document.getElementById('loadingSpinner').style.display = 'block';
    }

    function hideLoadingSpinner() {
      document.getElementById('loadingSpinner').style.display = 'none';
    }
  </script>
</body>
</html>
